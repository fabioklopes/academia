{% extends 'base.html' %}

{% block styles %}
<style>
    .action-buttons {
        visibility: hidden;
        opacity: 0;
        transition: visibility 0s, opacity 0.2s linear;
    }

    tr:hover .action-buttons {
        visibility: visible;
        opacity: 1;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>Alunos Cadastrados</h3>
        <a href="{% url 'new_student' %}" class="btn btn-primary">Novo Aluno</a>
    </div>
    <div class="card">
        <div class="card-body">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th scope="col">ALUNO</th>
                        <th scope="col">FAIXA</th>
                        <th scope="col">GRAUS</th>
                        <th scope="col">Contato</th>
                        <th scope="col" class="text-end">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td>
                            {% if student.image_profile %}
                                <img src="{{ student.image_profile.url }}" alt="Foto de {{ student.first_name }}" class="rounded-circle" width="40" height="40">
                            {% else %}
                                <span class="d-inline-block rounded-circle bg-secondary" style="width: 40px; height: 40px;"></span>
                            {% endif %}
                            &nbsp;
                            {{ student.first_name }} {{ student.last_name }}
                        </td>
                        <td>{{ student.get_current_belt_display }}</td>
                        <td>{{ student.get_current_degree_display }}</td>
                        <td>{{ student.phone }}</td>
                        <td class="text-end">
                            <div class="action-buttons">
                                <a href="{% url 'edit_student' user_id=student.id %}" class="btn btn-outline-primary btn-sm">Editar</a>
                                <a href="#" class="btn btn-outline-danger btn-sm" onclick="confirmDelete({{ student.id }})">Remover</a>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center">Nenhum aluno cadastrado.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Modal de Confirmação de Exclusão (opcional, mas recomendado) -->
<script>
function confirmDelete(studentId) {
    if (confirm("Tem certeza que deseja remover este aluno?")) {
        // Aqui você pode adicionar a lógica para redirecionar para uma view de remoção
        // Ex: window.location.href = `/api/alunos/removeraluno/${studentId}/`;
        alert("Aluno " + studentId + " removido (implementar a view de remoção)");
    }
}
</script>
{% endblock %}
